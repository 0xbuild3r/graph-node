<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This crate implements the store for all chain and subgraph data. See the [Store] for the details of how the store is organized across different databases/shards."><meta name="keywords" content="rust, rustlang, rust-lang, graph_store_postgres"><title>graph_store_postgres - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../favicon.svg">
<link rel="alternate icon" type="image/png" href="../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../graph_store_postgres/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><p class="location">Crate graph_store_postgres</p><div class="block version"><p>Version 0.23.1</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all graph_store_postgres's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></div><p class="location"></p><div id="sidebar-vars" data-name="graph_store_postgres" data-ty="mod" data-relpath="../"></div></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="">graph_store_postgres</a></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/graph_store_postgres/lib.rs.html#1-88" title="goto source code">[src]</a></span></h1><div class="docblock"><p>This crate implements the store for all chain and subgraph data. See the
<a href="../graph_store_postgres/store/struct.Store.html" title="Store">Store</a> for the details of how the store is organized across
different databases/shards.</p>
</div><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<table><tr class="module-item"><td><a class="mod" href="advisory_lock/index.html" title="graph_store_postgres::advisory_lock mod">advisory_lock</a></td><td class="docblock-short"><p>Helpers for using advisory locks. We centralize all use of these locks
in this module to make it easier to see what they are used for.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="block_range/index.html" title="graph_store_postgres::block_range mod">block_range</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="block_store/index.html" title="graph_store_postgres::block_store mod">block_store</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="catalog/index.html" title="graph_store_postgres::catalog mod">catalog</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="chain_head_listener/index.html" title="graph_store_postgres::chain_head_listener mod">chain_head_listener</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="chain_store/index.html" title="graph_store_postgres::chain_store mod">chain_store</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="command_support/index.html" title="graph_store_postgres::command_support mod">command_support</a></td><td class="docblock-short"><p>This module is only meant to support command line tooling. It must not
be used in ‘normal’ graph-node code</p>
</td></tr><tr class="module-item"><td><a class="mod" href="connection_pool/index.html" title="graph_store_postgres::connection_pool mod">connection_pool</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="copy/index.html" title="graph_store_postgres::copy mod">copy</a></td><td class="docblock-short"><p>This module if repsonsible for copying the data of an existing subgraph
<code>src</code> to a new subgraph <code>dst</code>. The copy is done in batches so that
copying does not cause long-running transactions since they lead to
table bloat in the rest of the system.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="deployment/index.html" title="graph_store_postgres::deployment mod">deployment</a></td><td class="docblock-short"><p>Utilities for dealing with deployment metadata. Any connection passed
into these methods must be for the shard that holds the actual
deployment data and metadata</p>
</td></tr><tr class="module-item"><td><a class="mod" href="deployment_store/index.html" title="graph_store_postgres::deployment_store mod">deployment_store</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="detail/index.html" title="graph_store_postgres::detail mod">detail</a></td><td class="docblock-short"><p>Queries to support the index node API</p>
</td></tr><tr class="module-item"><td><a class="mod" href="dynds/index.html" title="graph_store_postgres::dynds mod">dynds</a></td><td class="docblock-short"><p>SQL queries to load dynamic data sources</p>
</td></tr><tr class="module-item"><td><a class="mod" href="functions/index.html" title="graph_store_postgres::functions mod">functions</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="jobs/index.html" title="graph_store_postgres::jobs mod">jobs</a></td><td class="docblock-short"><p>Jobs for database maintenance</p>
</td></tr><tr class="module-item"><td><a class="mod" href="jsonb/index.html" title="graph_store_postgres::jsonb mod">jsonb</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="layout_for_tests/index.html" title="graph_store_postgres::layout_for_tests mod">layout_for_tests</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="notification_listener/index.html" title="graph_store_postgres::notification_listener mod">notification_listener</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="primary/index.html" title="graph_store_postgres::primary mod">primary</a></td><td class="docblock-short"><p>Utilities for dealing with subgraph metadata that resides in the primary
shard. Anything in this module can only be used with a database connection
for the primary shard.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="query_store/index.html" title="graph_store_postgres::query_store mod">query_store</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="relational/index.html" title="graph_store_postgres::relational mod">relational</a></td><td class="docblock-short"><p>Support for storing the entities of a subgraph in a relational schema,
i.e., one where each entity type gets its own table, and the table
structure follows the structure of the GraphQL type, using the
native SQL types that most appropriately map to the corresponding
GraphQL types</p>
</td></tr><tr class="module-item"><td><a class="mod" href="relational_queries/index.html" title="graph_store_postgres::relational_queries mod">relational_queries</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="sql_value/index.html" title="graph_store_postgres::sql_value mod">sql_value</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="store/index.html" title="graph_store_postgres::store mod">store</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="store_events/index.html" title="graph_store_postgres::store_events mod">store_events</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="subgraph_store/index.html" title="graph_store_postgres::subgraph_store mod">subgraph_store</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="unused/index.html" title="graph_store_postgres::unused mod">unused</a></td><td class="docblock-short"><p>Tools for managing unused deployments</p>
</td></tr></table><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.BlockStore.html" title="graph_store_postgres::BlockStore struct">BlockStore</a></td><td class="docblock-short"><p>The store that chains use to maintain their state and cache often used
data from a chain. The <code>BlockStore</code> maintains information about all
configured chains, and serves as a directory of chains, whereas the
<a href="../graph_store_postgres/chain_store/struct.ChainStore.html" title="ChainStore">ChainStore</a> manages chain-specific data. The <code>BlockStore</code> is sharded so
that each chain can use, depending on configuration, a separate database.
Regardless of configuration, the data for each chain is stored in its
own database namespace, though for historical reasons, the code also deals
with a shared table for the block and call cache for chains in the
<code>public</code> namespace.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ChainHeadUpdateListener.html" title="graph_store_postgres::ChainHeadUpdateListener struct">ChainHeadUpdateListener</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.ChainStore.html" title="graph_store_postgres::ChainStore struct">ChainStore</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.DeploymentDetail.html" title="graph_store_postgres::DeploymentDetail struct">DeploymentDetail</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.PRIMARY_SHARD.html" title="graph_store_postgres::PRIMARY_SHARD struct">PRIMARY_SHARD</a></td><td class="docblock-short"><p>The name of the primary shard that contains all instance-wide data</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Shard.html" title="graph_store_postgres::Shard struct">Shard</a></td><td class="docblock-short"><p>The name of a database shard; valid names must match <code>[a-z0-9_]+</code></p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Store.html" title="graph_store_postgres::Store struct">Store</a></td><td class="docblock-short"><p>The overall store of the system, consisting of a <a href="../graph_store_postgres/subgraph_store/struct.SubgraphStore.html" title="SubgraphStore">SubgraphStore</a> and a
<a href="../graph_store_postgres/block_store/struct.BlockStore.html" title="BlockStore">BlockStore</a>, each of which multiplex across multiple database shards.
The <code>SubgraphStore</code> is responsible for storing all data and metadata related
to individual subgraphs, and the <code>BlockStore</code> does the same for data belonging
to the chains that are being processed.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.SubgraphStore.html" title="graph_store_postgres::SubgraphStore struct">SubgraphStore</a></td><td class="docblock-short"><p>Multiplex store operations on subgraphs and deployments between a
primary and any number of additional storage shards. The primary
contains information about named subgraphs, and how the underlying
deployments are spread across shards, while the actual deployment data
and metadata is stored in the shards.  Depending on the configuration,
the database for the primary and for the shards can be the same
database, in which case they are all backed by one connection pool, or
separate databases in the same Postgres cluster, or entirely separate
clusters. Details of how to configure shards can be found in <a href="https://github.com/graphprotocol/graph-node/blob/master/docs/config.md">this
document</a></p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.SubscriptionManager.html" title="graph_store_postgres::SubscriptionManager struct">SubscriptionManager</a></td><td class="docblock-short"><p>Manage subscriptions to the <code>StoreEvent</code> stream. Keep a list of
currently active subscribers and forward new events to each of them</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.UnusedDeployment.html" title="graph_store_postgres::UnusedDeployment struct">UnusedDeployment</a></td><td class="docblock-short"></td></tr></table><h2 id="traits" class="section-header"><a href="#traits">Traits</a></h2>
<table><tr class="module-item"><td><a class="trait" href="trait.DeploymentPlacer.html" title="graph_store_postgres::DeploymentPlacer trait">DeploymentPlacer</a></td><td class="docblock-short"><p>Decide where a new deployment should be placed based on the subgraph name
and the network it is indexing. If the deployment can be placed, returns
the name of the database shard for the deployment and the names of the
indexers that should index it. The deployment should then be assigned to
one of the returned indexers.</p>
</td></tr></table><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<table><tr class="module-item"><td><a class="fn" href="fn.register_jobs.html" title="graph_store_postgres::register_jobs fn">register_jobs</a></td><td class="docblock-short"></td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="graph_store_postgres" data-search-js="../search-index.js"></div>
    <script src="../main.js"></script></body></html>