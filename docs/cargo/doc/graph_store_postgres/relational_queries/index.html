<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `relational_queries` mod in crate `graph_store_postgres`."><meta name="keywords" content="rust, rustlang, rust-lang, relational_queries"><title>graph_store_postgres::relational_queries - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../graph_store_postgres/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><p class="location">Module relational_queries</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></div><p class="location"><a href="../index.html">graph_store_postgres</a></p><div id="sidebar-vars" data-name="relational_queries" data-ty="mod" data-relpath="../"></div><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">graph_store_postgres</a>::<wbr><a class="mod" href="">relational_queries</a></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/graph_store_postgres/relational_queries.rs.html#1-2961" title="goto source code">[src]</a></span></h1><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.BASE_SQL_COLUMNS.html" title="graph_store_postgres::relational_queries::BASE_SQL_COLUMNS struct">BASE_SQL_COLUMNS</a></td><td class="docblock-short"><p>Those are columns that we always want to fetch from the database.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ClampRangeQuery.html" title="graph_store_postgres::relational_queries::ClampRangeQuery struct">ClampRangeQuery</a></td><td class="docblock-short"><p>Reduce the upper bound of the current entry’s block range to <code>block</code> as
long as that does not result in an empty block range</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ConflictingEntityData.html" title="graph_store_postgres::relational_queries::ConflictingEntityData struct">ConflictingEntityData</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.ConflictingEntityQuery.html" title="graph_store_postgres::relational_queries::ConflictingEntityQuery struct">ConflictingEntityQuery</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.CopyEntityBatchQuery.html" title="graph_store_postgres::relational_queries::CopyEntityBatchQuery struct">CopyEntityBatchQuery</a></td><td class="docblock-short"><p>Copy the data of one table to another table. All rows whose <code>vid</code> is in
the range <code>[first_vid, last_vid]</code> will be copied</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.CopyVid.html" title="graph_store_postgres::relational_queries::CopyVid struct">CopyVid</a></td><td class="docblock-short"><p>Helper struct for returning the id’s touched by the RevertRemove and
RevertExtend queries</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.DeleteByPrefixQuery.html" title="graph_store_postgres::relational_queries::DeleteByPrefixQuery struct">DeleteByPrefixQuery</a></td><td class="docblock-short"><p>Remove all entities from the given table whose id has a prefix that
matches one of the given prefixes. This query is mostly useful to
delete subgraph metadata that belongs to a certain dynamic data source</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.EntityData.html" title="graph_store_postgres::relational_queries::EntityData struct">EntityData</a></td><td class="docblock-short"><p>Helper struct for retrieving entities from the database. With diesel, we
can only run queries that return columns whose number and type are known
at compile time. Because of that, we retrieve the actual data for an
entity as Jsonb by converting the row containing the entity using the
<code>to_jsonb</code> function.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FilterQuery.html" title="graph_store_postgres::relational_queries::FilterQuery struct">FilterQuery</a></td><td class="docblock-short"><p>The parallel to <code>EntityQuery</code>.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FilterRange.html" title="graph_store_postgres::relational_queries::FilterRange struct">FilterRange</a></td><td class="docblock-short"><p>Generate `[limit {first}] [offset {skip}]</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FilterWindow.html" title="graph_store_postgres::relational_queries::FilterWindow struct">FilterWindow</a></td><td class="docblock-short"><p>This is the parallel to <code>EntityWindow</code>, with names translated to
the relational layout, and checked against it</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FindManyQuery.html" title="graph_store_postgres::relational_queries::FindManyQuery struct">FindManyQuery</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.FindQuery.html" title="graph_store_postgres::relational_queries::FindQuery struct">FindQuery</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.InsertQuery.html" title="graph_store_postgres::relational_queries::InsertQuery struct">InsertQuery</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.ORDER_BY_BLOCK_RANGE.html" title="graph_store_postgres::relational_queries::ORDER_BY_BLOCK_RANGE struct">ORDER_BY_BLOCK_RANGE</a></td><td class="docblock-short"><p>When we add <code>order by id</code> to a query should we add instead
<code>order by id, block_range</code></p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.PrefixComparison.html" title="graph_store_postgres::relational_queries::PrefixComparison struct">PrefixComparison</a></td><td class="docblock-short"><p>Produce a comparison between the string column <code>column</code> and the string
value <code>text</code> that makes it obvious to Postgres’ optimizer that it can
first consult the partial index on <code>left(column, STRING_PREFIX_SIZE)</code>
instead of going straight to a sequential scan of the underlying table.
We do this by writing the comparison <code>column op text</code> in a way that
involves <code>left(column, STRING_PREFIX_SIZE)</code></p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.QueryFilter.html" title="graph_store_postgres::relational_queries::QueryFilter struct">QueryFilter</a></td><td class="docblock-short"><p>A <code>QueryFilter</code> adds the conditions represented by the <code>filter</code> to
the <code>where</code> clause of a SQL query. The attributes mentioned in
the <code>filter</code> must all come from the given <code>table</code>, which is used to
map GraphQL names to column names, and to determine the type of the
column an attribute refers to</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.QueryValue.html" title="graph_store_postgres::relational_queries::QueryValue struct">QueryValue</a></td><td class="docblock-short"><p>A <code>QueryValue</code> makes it possible to bind a <code>Value</code> into a SQL query
using the metadata from Column</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.REVERSIBLE_ORDER_BY_OFF.html" title="graph_store_postgres::relational_queries::REVERSIBLE_ORDER_BY_OFF struct">REVERSIBLE_ORDER_BY_OFF</a></td><td class="docblock-short"><p>Reversible order by. Change our <code>order by</code> clauses so that <code>asc</code>
and <code>desc</code> ordering produce reverse orders. Setting this
turns the new, correct behavior off</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ReturnedEntityData.html" title="graph_store_postgres::relational_queries::ReturnedEntityData struct">ReturnedEntityData</a></td><td class="docblock-short"><p>Helper struct for returning the id’s touched by the RevertRemove and
RevertExtend queries</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.RevertClampQuery.html" title="graph_store_postgres::relational_queries::RevertClampQuery struct">RevertClampQuery</a></td><td class="docblock-short"><p>A query that unclamps the block range of all versions that contain
<code>block</code> by setting the upper bound of the block range to infinity.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.RevertRemoveQuery.html" title="graph_store_postgres::relational_queries::RevertRemoveQuery struct">RevertRemoveQuery</a></td><td class="docblock-short"><p>A query that removes all versions whose block range lies entirely
beyond <code>block</code>.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.SafeString.html" title="graph_store_postgres::relational_queries::SafeString struct">SafeString</a></td><td class="docblock-short"><p>A string where we have checked that it is safe to embed it literally
in a string in a SQL query. In particular, we have escaped any use
of the string delimiter <code>'</code>.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.TYPEA_BATCH_SIZE.html" title="graph_store_postgres::relational_queries::TYPEA_BATCH_SIZE struct">TYPEA_BATCH_SIZE</a></td><td class="docblock-short"><p>Use a variant of the query for child_type_a when we are looking up
fewer than this many entities. This variable is only here temporarily
until we can settle on the right batch size through experimentation
and should then just become an ordinary constant</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.UnsupportedFilter.html" title="graph_store_postgres::relational_queries::UnsupportedFilter struct">UnsupportedFilter</a></td><td class="docblock-short"></td></tr></table><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<table><tr class="module-item"><td><a class="enum" href="enum.Comparison.html" title="graph_store_postgres::relational_queries::Comparison enum">Comparison</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="enum" href="enum.FilterCollection.html" title="graph_store_postgres::relational_queries::FilterCollection enum">FilterCollection</a></td><td class="docblock-short"><p>This is a parallel to <code>EntityCollection</code>, but with entity type names
and filters translated in a form ready for SQL generation</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ParentIds.html" title="graph_store_postgres::relational_queries::ParentIds enum">ParentIds</a></td><td class="docblock-short"><p>A <code>ParentLink</code> where we’ve made sure for the <code>List</code> variant that each
<code>Vec&lt;Option&lt;String&gt;&gt;</code> has the same length
Use the provided constructors to make sure this invariant holds</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ParentLimit.html" title="graph_store_postgres::relational_queries::ParentLimit enum">ParentLimit</a></td><td class="docblock-short"><p>When we expand the parents for a specific query for children, we
sometimes (aka interfaces) need to restrict them to a specific
parent <code>q.id</code> that an outer query has already set up. In all other
cases, we restrict the children to the top n by ordering by a specific
sort key and limiting</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.SortKey.html" title="graph_store_postgres::relational_queries::SortKey enum">SortKey</a></td><td class="docblock-short"><p>Convenience to pass the name of the column to order by around. If <code>name</code>
is <code>None</code>, the sort key should be ignored</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.TableLink.html" title="graph_store_postgres::relational_queries::TableLink enum">TableLink</a></td><td class="docblock-short"><p>An <code>EntityLink</code> where we’ve resolved the entity type and attribute to the
corresponding table and column</p>
</td></tr></table><h2 id="traits" class="section-header"><a href="#traits">Traits</a></h2>
<table><tr class="module-item"><td><a class="trait" href="trait.ForeignKeyClauses.html" title="graph_store_postgres::relational_queries::ForeignKeyClauses trait">ForeignKeyClauses</a></td><td class="docblock-short"><p>Conveniences for handling foreign keys depending on whether we are using
<code>IdType::Bytes</code> or <code>IdType::String</code> as the primary key</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.FromColumnValue.html" title="graph_store_postgres::relational_queries::FromColumnValue trait">FromColumnValue</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="trait" href="trait.FromEntityData.html" title="graph_store_postgres::relational_queries::FromEntityData trait">FromEntityData</a></td><td class="docblock-short"></td></tr></table><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<table><tr class="module-item"><td><a class="fn" href="fn._impl_queryable_by_name_for_conflictingentitydata.html" title="graph_store_postgres::relational_queries::_impl_queryable_by_name_for_conflictingentitydata fn">_impl_queryable_by_name_for_conflictingentitydata</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="fn" href="fn._impl_queryable_by_name_for_copyvid.html" title="graph_store_postgres::relational_queries::_impl_queryable_by_name_for_copyvid fn">_impl_queryable_by_name_for_copyvid</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="fn" href="fn._impl_queryable_by_name_for_entitydata.html" title="graph_store_postgres::relational_queries::_impl_queryable_by_name_for_entitydata fn">_impl_queryable_by_name_for_entitydata</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="fn" href="fn._impl_queryable_by_name_for_returnedentitydata.html" title="graph_store_postgres::relational_queries::_impl_queryable_by_name_for_returnedentitydata fn">_impl_queryable_by_name_for_returnedentitydata</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="fn" href="fn.bytes_as_str.html" title="graph_store_postgres::relational_queries::bytes_as_str fn">bytes_as_str</a></td><td class="docblock-short"><p>Convert Postgres string representation of bytes “\xdeadbeef”
to ours of just “deadbeef”.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.jsonb_build_object.html" title="graph_store_postgres::relational_queries::jsonb_build_object fn">jsonb_build_object</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="fn" href="fn.str_as_bytes.html" title="graph_store_postgres::relational_queries::str_as_bytes fn">str_as_bytes</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="fn" href="fn.write_column_names.html" title="graph_store_postgres::relational_queries::write_column_names fn">write_column_names</a></td><td class="docblock-short"></td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="graph_store_postgres" data-search-js="../../search-index.js"></div>
    <script src="../../main.js"></script></body></html>